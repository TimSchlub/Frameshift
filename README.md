Supplementary material 3 for "A simple method to detect candidate overlapping genes in viruses using single genome sequences"
Timothy E. Schlub, Jan P. Buchmann, Edward C. Holmes

R code for the two methods introduced: the codon permutation method and synonymous mutation method. To run this analysis, three values must be inputted in the first three lines of code. These are (1) nuc – representing the nucleotide sequence to be analysed, (2) n – representing the number of repeats to be used for the codon permutation test, and (3) n_synon – representing the number of repeats to be used for the synonymous mutation method. Example values for these have been pre-populated that replicate the ORF finding for the first entry of supplementary material 2 – the list of discovered ORFs. Running the entirety of the code in R will generate an R data frame titled “Results” (which is case sensitive). This data frame will list every ORF for every reading frame for the nucleotide sequence “nuc_ORF”, the length of that ORF in codons “aa_length”, the P-value for the codon permutation method “Pval_permute”, the P-value for the synonymous mutation method “Pval_synon”, the reading frame the ORF lies on “fs” (note that the frames plus_0, plus_1, plus_2, com_plus_0, com_plus_1, com_plus_2, rev_plus_0, rev_plus_1, rev_plus_2, revcom_plus_0, revcom_plus_1 and revcom_plus_2 correspond to reading frames +0, +1, +2, +c0, +c1, +c2, -0, -1, -2, -c0, -c1, and -c2 as defined by supplementary material 1 respectively), the ORF start position “nstart”, and ORF end position “end”. The code also requires the r data file Codon_table.rds” to be in the working directory to run (available from https://github.com/TimSchlub/Frameshift). The codon permutation method is coded into the function “codon_permute_bootstrap”. The function “synonymous_mutation_bootstrap” is the equivalent function for the synonymous mutation test. These two functions rely on the custom functions “strReverse”, “complem”, “findORF”, and “synonymousMutaiton” to reverse strings, substitute for complementary nucleotides, find ORFs bookended by codons, and introduce random synonymous mutations respectively. 

